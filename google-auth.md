# Flow

* *Пользователь* жмет гугл-кнпоку и
  - Либо выбирает залогиненый гугл аккаунт
  - Либо логиниться
  - Если не логиниться по любым причниам, то бек про это ничего не узнает
* *js* получает токен авторизации у гугла
* *js* шлет токен на бек (например POST /auth?provider=google)
* *php* принимает токен и тянет юзер инфо с гугла используя этот токен вот [так](https://developers.google.com/identity/sign-in/web/backend-auth)
  - Если вытянуть инфо удалось
    * юзера нет в БД (проверка по email) - записать юзера в бд (что, кроме мыла пишем?)
    * юзер есть в БД (обновляем данные?) (нужно?) (ава может поменяться, например)
    * Инициализируем сессию и отдаем *НАШ* ид сессии (auth token). Через куки или просто в JSON response (отдавать юзер инфо?)
  - Если вытянуть инфо не удалось
    * 401 unauthorized error
* js шлет auth token в последующих запросах

# Дополнительно

* logout endpoint (/logout) (POST?)
* endpoint для получения инфы о текущем пользователе (/users/current). 401 - unauthorized если не залогинен
* сервер должен возвращать 401 - unauthorized на любой запрос требующий авторизации
